<!DOCTYPE html>
<html><head>
<meta charset="UTF-8">
<title>Speech Timer Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/dashboard.css">
</head><body>
<div class="container">
<h1>&#x1F3A4; Speech Timer Dashboard</h1>
<div class="subtitle">Real-time monitoring and control &bullet; <span id="refresh-status">Loading...</span></div>

<!-- Status Dashboard -->
<div class="dashboard">
  <div class="card">
    <h3>&#x23F0; Current Time</h3>
    <div class="value" id="time-value">--:--:--</div>
    <div class="label" id="time-label">Loading...</div>
  </div>
  <div class="card">
    <h3>&#127918; Current Mode</h3>
    <div class="value" style="font-size:18px;" id="mode-name">Loading...</div>
    <div class="status"><div class="status-dot status-offline" id="mode-dot"></div><span id="mode-status">Loading...</span></div>
  </div>
  <div class="card">
    <h3>&#x1F321; CPU Temperature</h3>
    <div class="value" id="temp-c">--&deg;C</div>
    <div class="label" id="temp-f">--&deg;F</div>
  </div>
  <div class="card">
    <h3>&#x1F3A8; Display Color</h3>
    <div><span class="color-preview" style="background:rgb(128,128,128);" id="color-preview"></span></div>
    <div class="label" id="color-label">RGB(-, -, -)</div>
  </div>
</div>

<!-- Speech Timer Control -->
<div class="section">
  <h2>&#x23F1; Speech Timer Control</h2>
  <form method="POST" action="/">
    <div class="form-group">
      <label>Min Time:</label>
      <input type="number" id="min-time-input" name="MIN_TIME" value="5" min="1" max="60"> minutes
    </div>
    <div class="form-group">
      <label>Max Time:</label>
      <input type="number" id="max-time-input" name="MAX_TIME" value="7" min="1" max="60"> minutes
    </div>
    <button class="success" type="button" data-submit="true" name="TIMER" value="START" id="timer-btn">&#x25B6; Start Timer</button>
  </form>
</div>

<!-- Clock Color Control -->
<div class="section">
  <h2>&#x1F3A8; Clock Color Settings</h2>
  <form method="POST" action="/">
    <div class="form-group">
      <label>Red:</label>
      <input type="number" id="red-input" name="RED" value="255" min="0" max="255">
    </div>
    <div class="form-group">
      <label>Green:</label>
      <input type="number" id="green-input" name="GREEN" value="255" min="0" max="255">
    </div>
    <div class="form-group">
      <label>Blue:</label>
      <input type="number" id="blue-input" name="BLUE" value="255" min="0" max="255">
    </div>
    <button type="button" data-submit="true" name="CLOCK" value="SET">Apply Clock Color</button>
  </form>
</div>

<!-- System Controls -->
<div class="section">
  <h2>&#9881;&#65039; System Controls</h2>
  <form method="POST" action="/" style="display:inline;">
    <button type="button" data-submit="true" name="TEST" value="START">&#128300; Start Test Mode</button>
  </form>
  <form method="POST" action="/" style="display:inline;">
    <button type="button" data-submit="true" name="MODE" value="CLOCK">&#x1F551; Show Clock</button>
  </form>
</div>

<!-- System Information -->
<div class="section">
  <h2>&#128200; System Information</h2>
  <div class="info-grid">
    <div class="info-item"><span class="info-label">WiFi Status:</span><span class="info-value" id="wifi-status">Loading...</span></div>
    <div class="info-item"><span class="info-label">IP Address:</span><span class="info-value" id="ip-addr">Loading...</span></div>
    <div class="info-item"><span class="info-label">Requests:</span><span class="info-value" id="request-count">0</span></div>
  </div>
</div>

<!-- API Links -->
<div class="api-links">
  <strong>JSON API Endpoints:</strong><br>
  <a href="/api/status" target="_blank">Status</a> |
  <a href="/api/system" target="_blank">System</a> |
  <a href="/api/time" target="_blank">Time</a>
</div>

</div>
<script>
(function loadDashboardJs(attempt) {
  var maxAttempts = 3;
  var script = document.createElement('script');
  script.src = '/js/dashboard.js?v=' + Date.now() + '_' + attempt;
  script.defer = true;
  script.onerror = function() {
    if (attempt < maxAttempts) {
      setTimeout(function() { loadDashboardJs(attempt + 1); }, 500 * attempt);
    }
  };
  document.body.appendChild(script);
})(1);
</script>
</body></html>
